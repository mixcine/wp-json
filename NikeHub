local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local Config = { Duration = 10, FadeTime = 2 }

-- Create the loading screen GUI
local function CreateInterface()
    local gui = Instance.new("ScreenGui")
    gui.Name = "LynixHubBrookhaven"
    gui.Parent = PlayerGui
    gui.ResetOnSpawn = false
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    gui.IgnoreGuiInset = true
    gui.ScreenInsets = Enum.ScreenInsets.None

    local main = Instance.new("Frame")
    main.Parent = gui
    main.BackgroundTransparency = 1
    main.Size = UDim2.new(1, 0, 1, 0)
    main.ZIndex = 10

    local bgImage = Instance.new("ImageLabel")
    bgImage.Parent = main
    bgImage.BackgroundTransparency = 1
    bgImage.Size = UDim2.new(1, 0, 1, 0)
    bgImage.Image = "rbxassetid://92938877761950"
    bgImage.ScaleType = Enum.ScaleType.Stretch
    bgImage.ZIndex = 1

    local center = Instance.new("Frame")
    center.Parent = main
    center.BackgroundTransparency = 1
    center.Size = UDim2.new(0, 700, 0, 150)
    center.Position = UDim2.new(0.5, -350, 0.7, -75)
    center.ZIndex = 20

    local title = Instance.new("TextLabel")
    title.Parent = center
    title.BackgroundTransparency = 1
    title.Size = UDim2.new(1, 0, 0, 50)
    title.Text = "Lynix Hub"
    title.TextColor3 = Color3.fromRGB(0, 0, 0)
    title.TextScaled = true
    title.Font = Enum.Font.GothamBold
    title.ZIndex = 21

    local titleStroke = Instance.new("UIStroke")
    titleStroke.Parent = title
    titleStroke.Color = Color3.fromRGB(139, 0, 0)
    titleStroke.Thickness = 4

    local progBg = Instance.new("Frame")
    progBg.Parent = center
    progBg.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    progBg.Size = UDim2.new(1, 0, 0, 35)
    progBg.Position = UDim2.new(0, 0, 0, 60)
    progBg.ZIndex = 19

    local progCorner = Instance.new("UICorner")
    progCorner.CornerRadius = UDim.new(0, 17)
    progCorner.Parent = progBg

    local progStroke = Instance.new("UIStroke")
    progStroke.Parent = progBg
    progStroke.Color = Color3.fromRGB(139, 0, 0)
    progStroke.Thickness = 3

    local progressBar = Instance.new("Frame")
    progressBar.Parent = progBg
    progressBar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    progressBar.Size = UDim2.new(0, 0, 1, 0)
    progressBar.ZIndex = 20

    local barCorner = Instance.new("UICorner")
    barCorner.CornerRadius = UDim.new(0, 17)
    barCorner.Parent = progressBar

    local barStroke = Instance.new("UIStroke")
    barStroke.Parent = progressBar
    barStroke.Color = Color3.fromRGB(139, 0, 0)
    barStroke.Thickness = 2

    local barGrad = Instance.new("UIGradient")
    barGrad.Parent = progressBar
    barGrad.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 0, 0)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(50, 0, 0)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 0, 0))
    })

    local percentage = Instance.new("TextLabel")
    percentage.Parent = center
    percentage.BackgroundTransparency = 1
    percentage.Size = UDim2.new(1, 0, 0, 40)
    percentage.Position = UDim2.new(0, 0, 0, 110)
    percentage.Text = "0%"
    percentage.TextColor3 = Color3.fromRGB(0, 0, 0)
    percentage.TextScaled = true
    percentage.Font = Enum.Font.GothamBold
    percentage.ZIndex = 21

    local percentStroke = Instance.new("UIStroke")
    percentStroke.Parent = percentage
    percentStroke.Color = Color3.fromRGB(139, 0, 0)
    percentStroke.Thickness = 4

    return gui, progressBar, percentage, main
end

-- Start the loading animation
local function StartLoading()
    local gui, progressBar, percentage, mainFrame = CreateInterface()
    local startTime = tick()

    local connection
    connection = RunService.Heartbeat:Connect(function()
        local elapsed = tick() - startTime
        local progress = math.min(elapsed / Config.Duration, 1)
        progressBar:TweenSize(UDim2.new(progress, 0, 1, 0), "Out", "Quart", 0.2, true)
        percentage.Text = math.floor(progress * 100) .. "%"

        if progress >= 1 then
            connection:Disconnect()
            task.wait(1)
            local fadeOut = TweenService:Create(mainFrame, TweenInfo.new(Config.FadeTime, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
                BackgroundTransparency = 1
            })
            fadeOut:Play()
            fadeOut.Completed:Connect(function()
                gui:Destroy()
            end)
        end
    end)
end

StartLoading()

-- Grab network ownership globally (essential for flinging others)
spawn(function()
    while true do
        pcall(function()
            LocalPlayer.ReplicationFocus = Workspace
            LocalPlayer.MaximumSimulationRadius = math.huge
            LocalPlayer.SimulationRadius = math.huge
        end)
        RunService.Stepped:Wait()
    end
end)

-- Load external library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/ndark5243-arch/Libraryhanzodred/refs/heads/main/Main.txt"))()

workspace.FallenPartsDestroyHeight = -math.huge

-- Create main window
local Window = Library:MakeWindow({
    Title = "Lynix Hub üè° | Brookhaven RP",
    SubTitle = "by: Shadow, Void777, God777",
    LoadText = "Carregando Lynix Hub",
    Flags = "LynixHub_Brookhaven"
})
Window:AddMinimizeButton({
    Button = { Image = "rbxassetid://92938877761950", BackgroundTransparency = 1 },
    Corner = { CornerRadius = UDim.new(0, 35) }
})

-- Troll tab
local TrollTab = Window:MakeTab({"Troll", "skull"})

local selectedPlayer
local isSpectating = false
local spectatedPlayer
local characterConnection

local function getPlayerNames()
    local playerNames = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            table.insert(playerNames, player.Name)
        end
    end
    return playerNames
end

local function updateDropdown(dropdown, spectateToggle)
    local currentValue = dropdown:Get()
    local playerNames = getPlayerNames()
    dropdown:Set(playerNames)
    if currentValue and not table.find(playerNames, currentValue) then
        dropdown:Set("")
        selectedPlayer = nil
        if isSpectating then
            stopSpectating()
            spectateToggle:Set(false)
        end
    elseif currentValue and table.find(playerNames, currentValue) then
        dropdown:Set(currentValue)
    end
end

local function spectatePlayer(playerName)
    if characterConnection then
        characterConnection:Disconnect()
        characterConnection = nil
    end

    local targetPlayer = Players:FindFirstChild(playerName)
    if targetPlayer and targetPlayer ~= LocalPlayer then
        spectatedPlayer = targetPlayer
        isSpectating = true

        local function updateCamera()
            if not isSpectating or not spectatedPlayer then return end
            local humanoid = spectatedPlayer.Character and spectatedPlayer.Character:FindFirstChild("Humanoid")
            Workspace.CurrentCamera.CameraSubject = humanoid or nil
        end

        updateCamera()
        characterConnection = RunService.Heartbeat:Connect(updateCamera)
        spectatedPlayer.CharacterAdded:Connect(function()
            if isSpectating then updateCamera() end
        end)
    else
        isSpectating = false
        spectatedPlayer = nil
    end
end

local function stopSpectating()
    if characterConnection then
        characterConnection:Disconnect()
        characterConnection = nil
    end

    isSpectating = false
    spectatedPlayer = nil
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
    Workspace.CurrentCamera.CameraSubject = humanoid or nil
    Workspace.CurrentCamera.CameraType = Enum.CameraType.Custom
end

local function teleportToPlayer(playerName)
    local targetPlayer = Players:FindFirstChild(playerName)
    if not (targetPlayer and LocalPlayer.Character and targetPlayer.Character) then
        print("Jogador ou personagem n√£o encontrado.")
        return
    end

    local myHRP = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    local myHumanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
    local targetHRP = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not (myHRP and myHumanoid and targetHRP) then
        print("Personagem n√£o est√° carregado para teletransporte.")
        return
    end

    for _, part in ipairs(LocalPlayer.Character:GetDescendants()) do
        if part:IsA("BasePart") then
            part.Velocity = Vector3.zero
            part.RotVelocity = Vector3.zero
            part.Anchored = true
        end
    end

    myHRP.CFrame = CFrame.new(targetHRP.Position + Vector3.new(0, 2, 0))
    myHumanoid.Sit = false
    myHumanoid:ChangeState(Enum.HumanoidStateType.GettingUp)

    task.wait(0.5)
    for _, part in ipairs(LocalPlayer.Character:GetDescendants()) do
        if part:IsA("BasePart") then
            part.Anchored = false
            part.Velocity = Vector3.zero
            part.RotVelocity = Vector3.zero
        end
    end

    print("Teletransportado para " .. playerName .. ".")
end

-- Fling Ball V3 - Improved (Targets selected player for void/fling)
local function flingBallV3()
    if not selectedPlayer or not selectedPlayer.Character then
        warn("Selecione um jogador alvo primeiro!")
        return
    end

    local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
    local targetCharacter = selectedPlayer.Character
    local targetHRP = targetCharacter:FindFirstChild("HumanoidRootPart")
    if not targetHRP then
        warn("Personagem do alvo n√£o carregado!")
        return
    end

    local FLING_FORCE = 999999
    local SPAM_COUNT = 50  -- Increased for stronger fling effect
    local SPAM_DELAY = 0.01  -- Faster spam for rapid hits
    local OFFSET = Vector3.new(0, 5, 0)  -- Slight offset to hit from above

    local function hasSoccerBall()
        return Character:FindFirstChild("SoccerBall") ~= nil
    end

    if not hasSoccerBall() then
        warn("Sem SoccerBall! Pegue uma bola no jogo primeiro.")
        return
    end

    local SoccerBall = Character.SoccerBall
    local FootballRemote = SoccerBall:WaitForChild("FootballInteraction")

    -- Function to generate a fling CFrame targeted at the player
    local function generateTargetCFrame()
        local targetPos = targetHRP.Position + OFFSET
        -- Create a CFrame that points towards the target with random rotation for chaotic fling
        local lookDirection = (targetPos - HumanoidRootPart.Position).Unit
        local randomRotation = CFrame.Angles(
            math.rad(math.random(-180, 180)),
            math.rad(math.random(-180, 180)),
            math.rad(math.random(-180, 180))
        )
        return CFrame.new(targetPos, targetPos + lookDirection) * randomRotation
    end

    -- Spam the remote with targeted CFrames to repeatedly "teleport" the ball into the target, causing server-side flings
    spawn(function()
        for i = 1, SPAM_COUNT do
            local targetCFrame = generateTargetCFrame()
            pcall(function()
                FootballRemote:FireServer(targetCFrame)
            end)
            task.wait(SPAM_DELAY)
        end
        print("Fling bola spamado no alvo! Isso deve flingar ele de verdade via colis√µes da bola.")
    end)

    -- Optional: Follow up with direct velocity if ownership is active (backup)
    spawn(function()
        task.wait(0.5)
        pcall(function()
            targetHRP.AssemblyLinearVelocity = Vector3.new(
                math.random(-FLING_FORCE, FLING_FORCE),
                FLING_FORCE * 2,  -- Upward fling for dramatic effect
                math.random(-FLING_FORCE, FLING_FORCE)
            )
        end)
    end)
end

-- Player dropdown
local selectedPlayerName
local PlayerDropdown = TrollTab:AddDropdown({
    Name = "Selecionar Jogador",
    Description = "Escolha um jogador para visualizar ou teletransportar",
    Default = "",
    Multi = false,
    Options = getPlayerNames(),
    Flag = "player_list",
    Callback = function(playerName)
        selectedPlayerName = playerName
        selectedPlayer = playerName and playerName ~= "" and Players:FindFirstChild(playerName) or nil
        if not selectedPlayer and isSpectating then
            stopSpectating()
            SpectateToggle:Set(false)
        elseif isSpectating then
            stopSpectating()
            spectatePlayer(playerName)
        end
    end
})

TrollTab:AddButton({
    Name = "Atualizar Lista",
    Callback = function()
        PlayerDropdown:Set(getPlayerNames())
    end
})

---===troll sof√°===---
local function equipSofa()
    local backpack = LocalPlayer:WaitForChild("Backpack")
    local sofa = backpack:FindFirstChild("Couch") or LocalPlayer.Character:FindFirstChild("Couch")
    if not sofa then
        local args = { [1] = "PickingTools", [2] = "Couch" }
        local success = pcall(function()
            ReplicatedStorage:WaitForChild("RE"):WaitForChild("1Too1l"):InvokeServer(unpack(args))
        end)
        if not success then return false end
        repeat
            sofa = backpack:FindFirstChild("Couch")
            task.wait()
        until sofa or task.wait(5)
        if not sofa then return false end
    end
    if sofa.Parent ~= LocalPlayer.Character then
        sofa.Parent = LocalPlayer.Character
    end
    return true
end

local function killWithSofa(targetPlayer)
    if not targetPlayer or not targetPlayer.Character or not LocalPlayer.Character then return end
    if not equipSofa() then return end
    isFollowingKill = true
    originalPosition = LocalPlayer.Character:FindFirstChild("HumanoidRootPart").Position
end

local function pullWithSofa(targetPlayer)
    if not targetPlayer or not targetPlayer.Character or not LocalPlayer.Character then return end
    if not equipSofa() then return end
    isFollowingPull = true
    originalPosition = LocalPlayer.Character:FindFirstChild("HumanoidRootPart").Position
end

TrollTab:AddButton({
    Name = "Matar",
    Description = "Inicia o matar com o m√©todo selecionado",
    Callback = function()
        if isFollowingKill or isFollowingPull or running then return end
        if not selectedPlayer or not selectedKillPullMethod then return end
        if selectedKillPullMethod == "Sof√°" then
            killWithSofa(selectedPlayer)
        elseif selectedKillPullMethod == "√înibus" then
            killWithBus(selectedPlayer)
        end
    end
})

---===fechamento===---
-- Teleport button
TrollTab:AddButton({
    Name = "Teleportar para Jogador",
    Description = "Teletransporta para o jogador selecionado",
    Callback = function()
        if selectedPlayerName and selectedPlayerName ~= "" then
            pcall(teleportToPlayer, selectedPlayerName)
        else
            print("Selecione um jogador antes de teletransportar.")
        end
    end
})

-- Spectate toggle
local SpectateToggle = TrollTab:AddToggle({
    Name = "Visualizar Jogador",
    Description = "Ativa/desativa a visualiza√ß√£o do jogador selecionado",
    Default = false,
    Callback = function(state)
        if state then
            if selectedPlayer then
                spectatePlayer(selectedPlayer.Name)
            else
                SpectateToggle:Set(false)
            end
        else
            stopSpectating()
        end
    end
})

----troll v2 lag servidor 

-- Servi√ßos e Globals (adicione se n√£o tiver)
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")  -- Para loops suaves
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Player = Players.LocalPlayer

-- Assuma RE folder e remotes (adicione um DamageEvent se o jogo tiver; sen√£o, use FireEvent pra dano)
local RE = ReplicatedStorage:WaitForChild("RE")
local ClearEvent = RE:FindFirstChild("1Clea1rTool1s")
local ToolEvent = RE:FindFirstChild("1Too1l")
local FireEvent = RE:FindFirstChild("1Gu1n")
local SoundRemote = RE:FindFirstChild("1Gu1nSound1s")
local DamageEvent = RE:FindFirstChild("DamagePlayer") or FireEvent  -- Fallback pra dano; adapte

-- Fun√ß√µes Globais (de tools, do c√≥digo anterior - copie se precisar)
local function clearAllTools() if ClearEvent then pcall(ClearEvent.FireServer, ClearEvent, "ClearAllTools") end end
local function getAssault() if ToolEvent then pcall(ToolEvent.InvokeServer, ToolEvent, "PickingTools", "Assault") end end
local function hasAssault() return Player.Backpack:FindFirstChild("Assault") ~= nil end
local function fireAtPart(targetPart) 
    local char = Player.Character; if not char then return end
    local gunScript = char:FindFirstChild("Assault") and char.Assault:FindFirstChild("GunScript_Local")
    if not gunScript or not targetPart then return end
    local args = {targetPart, targetPart, Vector3.new(1e14,1e14,1e14), targetPart.Position, gunScript:FindFirstChild("MuzzleEffect"), gunScript:FindFirstChild("HitEffect"), 0,0,{false}, {25, Vector3.new(100,100,100), BrickColor.new(29),0.25,Enum.Material.SmoothPlastic,0.25}, true, false}
    pcall(FireEvent.FireServer, FireEvent, unpack(args))
end
local function fireAtAllPlayers(times, cancelFlag) 
    for i=1,times do if cancelFlag[1] then break end
        for _,p in ipairs(Players:GetPlayers()) do if p~=Player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then fireAtPart(p.Character.HumanoidRootPart); task.wait(0.05) end end  -- Delay menor pra mais agressivo
    end
end
local function spamChat(message) 
    local TextChatService = game:GetService("TextChatService")
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then TextChatService.TextChannels.RBXGeneral:SendAsync(message) end
end

-- Se√ß√£o Jujutsu Kaisen (Avan√ßada)
local cancelExpansion = false
local expansionActive = false
local expansionModel = nil
local expansionSounds = {}
local originalSky = nil
local expansionConnection = nil  -- Pra loop de DoT
local radius = 250  -- Raio do dom√≠nio (expande pra 500)

TrollTab:AddSection({"Jujutsu Kaisen"})

TrollTab:AddToggle({  -- Toggle em vez de button
    Name = "[OP] Domain Expansion - Gojo (Avan√ßado)",
    Default = false,
    Callback = function(state)
        expansionActive = state
        if state then
            cancelExpansion = false
            spamChat("hi\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\rDomain Expansion: Infinite Void!")
            
            ativarDominioAvancado()  -- Fun√ß√£o principal
            
            -- Loop de Disparos (agora mais agressivo: 5 rodadas)
            local cancelFlag = {cancelExpansion}
            task.spawn(function()
                while not cancelFlag[1] do
                    clearAllTools(); getAssault()
                    repeat task.wait(0.1) until hasAssault() or cancelFlag[1]  -- Espera mais r√°pida
                    if not cancelFlag[1] then fireAtAllPlayers(5, cancelFlag); task.wait(0.8) end  -- Mais tiros, menos wait
                end
            end)
            
            -- Loop de Som Extra (ID v√°lido: som de "vazio")
            local soundID = 1843527678
            task.spawn(function()
                while not cancelExpansion do
                    if SoundRemote then pcall(SoundRemote.FireServer, SoundRemote, workspace, soundID, 1.5) end  -- Volume maior
                    local char = Player.Character; if char then
                        local root = char:FindFirstChild("HumanoidRootPart"); if root then
                            local sound = Instance.new("Sound", root); sound.SoundId = "rbxassetid://" .. soundID; sound.Volume = 1.2; sound.Looped = false; sound:Play()
                            table.insert(expansionSounds, sound)
                            sound.Ended:Connect(function() if sound then sound:Destroy(); table.remove(expansionSounds, table.find(expansionSounds, sound)) end end)
                            task.wait(3)  -- Intervalo pro loop de som
                        end
                    else break end
                end
            end)
        else
            cancelarDominioAvancado()
        end
    end
})

-- Fun√ß√£o Principal: Ativa√ß√£o Avan√ßada
function ativarDominioAvancado()
    local char = Player.Character or Player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    
    -- Cria Modelo
    local dominio = Instance.new("Model"); dominio.Name = "InfiniteVoidAdvanced"; dominio.Parent = workspace; expansionModel = dominio
    
    -- Esfera Principal (come√ßa pequena)
    local esfera = Instance.new("Part", dominio); esfera.Shape = Enum.PartType.Ball; esfera.Size = Vector3.new(10,10,10); esfera.Position = hrp.Position; 
    esfera.Anchored = true; esfera.CanCollide = false; esfera.Material = Enum.Material.ForceField; esfera.Transparency = 0.5; 
    esfera.Color = Color3.fromRGB(0,0,50);  -- Azul escuro pro vazio
    
    -- Tween de Expans√£o (5s pra expandir)
    local expandTween = TweenService:Create(esfera, TweenInfo.new(5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = Vector3.new(500,500,500), Transparency = 0.2})
    expandTween:Play()
    radius = 250  -- Atualiza raio final
    
    -- Luz Pulsante
    local luz = Instance.new("PointLight", esfera); luz.Color = Color3.fromRGB(0,153,255); luz.Brightness = 5; luz.Range = 100
    local luzTween = TweenService:Create(luz, TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {Brightness = 15, Range = 500})
    luzTween:Play()
    
    -- Part√≠culas Avan√ßadas (3 emitters)
    -- Principal: Azul emitindo pra fora
    local ps1 = Instance.new("ParticleEmitter", esfera); ps1.Texture = "rbxassetid://243660364"; ps1.Color = ColorSequence.new(Color3.fromRGB(0,153,255)); 
    ps1.LightEmission = 1; ps1.Size = NumberSequence.new{NumberSequenceKeypoint.new(0,2), NumberSequenceKeypoint.new(1,5)}; ps1.Transparency = NumberSequence.new(0.3); 
    ps1.Rate = 500; ps1.Lifetime = NumberRange.new(3,5); ps1.Speed = NumberRange.new(20,50); ps1.VelocitySpread = 360; ps1.SpreadAngle = Vector2.new(180,180)
    
    -- Secund√°ria: Roxo pra "vazio"
    local ps2 = Instance.new("ParticleEmitter", esfera); ps2.Texture = "rbxassetid://241650934"; ps2.Color = ColorSequence.new(Color3.fromRGB(128,0,128)); 
    ps2.Rate = 300; ps2.Lifetime = NumberRange.new(4); ps2.Speed = NumberRange.new(10,30); ps2.Acceleration = Vector3.new(0,-50,0)  -- Cai devagar
    
    -- Terceira: Negro pra distor√ß√£o
    local ps3 = Instance.new("ParticleEmitter", esfera); ps3.Texture = "rbxassetid://2999122327"; ps3.Color = ColorSequence.new(Color3.new(0,0,0)); 
    ps3.Rate = 200; ps3.Lifetime = NumberRange.new(2,4); ps3.Speed = NumberRange.new(5); ps3.Drag = 5  -- Lento e pegajoso
    
    -- Som Loopado na Esfera
    local som = Instance.new("Sound", esfera); som.SoundId = "rbxassetid://1843527678"; som.Volume = 3; som.Looped = true; som:Play()
    table.insert(expansionSounds, som)
    
    -- Efeitos no Lighting (Distortion)
    originalSky = Lighting:FindFirstChildOfClass("Sky"); if originalSky then originalSky.Parent = nil end
    local newSky = Instance.new("Sky", Lighting); newSky.SkyboxBk = "rbxassetid://159454299"  -- Texturas originais, mas adicionei
    newSky.SkyboxDn = "rbxassetid://159454296"; newSky.SkyboxFt = "rbxassetid://159454293"; newSky.SkyboxLf = "rbxassetid://159454286"
    newSky.SkyboxRt = "rbxassetid://159454300"; newSky.SkyboxUp = "rbxassetid://159454288"
    
    -- ColorCorrection pra "sobrecarga" (desbota cores)
    local cc = Instance.new("ColorCorrectionEffect", Lighting); cc.Brightness = 0; cc.Contrast = -0.5; cc.Saturation = -0.8; cc.TintColor = Color3.fromRGB(100,150,255)
    local ccTween = TweenService:Create(cc, TweenInfo.new(10, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1, true), {Brightness = 0.2, Contrast = 0, Saturation = 0})
    ccTween:Play()
    
    -- Efeito no Seu Personagem (Flutuar)
    if hrp then
        local bodyVel = Instance.new("BodyVelocity", hrp); bodyVel.MaxForce = Vector3.new(0, math.huge, 0); bodyVel.Velocity = Vector3.new(0, 2, 0)  -- Flutua devagar
        task.wait(10); if bodyVel then bodyVel:Destroy() end  -- Remove ap√≥s 10s
    end
    
    -- Loop de DoT (Dano Over Time) - Checa players dentro
    expansionConnection = RunService.Heartbeat:Connect(function()
        if cancelExpansion then return end
        local center = esfera.Position
        for _, p in ipairs(Players:GetPlayers()) do
            if p ~= Player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                local dist = (p.Character.HumanoidRootPart.Position - center).Magnitude
                if dist < radius then
                    -- Dano passivo (5 HP/seg, mas s√≥ a cada 1s pra n√£o spam)
                    pcall(function() DamageEvent:FireServer(p.Character.Humanoid, 5) end)  -- Envia dano pro server
                    -- Efeito Visual: Transpar√™ncia tempor√°ria (client-side, s√≥ voc√™ v√™)
                    local humanoid = p.Character:FindFirstChild("Humanoid")
                    if humanoid then
                        for _, part in ipairs(p.Character:GetChildren()) do if part:IsA("BasePart") then
                            TweenService:Create(part, TweenInfo.new(0.5), {Transparency = 0.7}):Play()
                            task.spawn(function() task.wait(0.5); TweenService:Create(part, TweenInfo.new(0.5), {Transparency = 0}):Play() end)
                        end end
                    end
                end
            end
        end
    end)
end

-- Fun√ß√£o de Cancel Avan√ßada
function cancelarDominioAvancado()
    cancelExpansion = true
    expansionActive = false
    
    -- Para sons
    for _, sound in ipairs(expansionSounds) do if sound then sound:Stop(); sound:Destroy() end end
    expansionSounds = {}
    
    -- Destr√≥i modelo e effects
    if expansionModel then expansionModel:Destroy(); expansionModel = nil end
    local currentSky = Lighting:FindFirstChildOfClass("Sky"); if currentSky then currentSky:Destroy() end
    if originalSky then originalSky.Parent = Lighting; originalSky = nil end
    local cc = Lighting:FindFirstChildOfClass("ColorCorrectionEffect"); if cc then cc:Destroy() end
    
    -- Para loops
    if expansionConnection then expansionConnection:Disconnect(); expansionConnection = nil end
end



---------------------------------------------------------------------------------------------------------------------------------
                                                   -- === TrollTab: Lag Server === --
---------------------------------------------------------------------------------------------------------------------------------

-- Shutdown Custom Section
local Section = TrollTab:AddSection({
    Name = "Shutdown Personalizado"
})

-- Shutdown Server Button
TrollTab:AddButton({
    Name = "Shutdown Servidor",
    Callback = function()
        for m = 1, 495 do
            local args = {
                [1] = "PickingTools",
                [2] = "FireHose"
            }
            game:GetService("ReplicatedStorage").RE:FindFirstChild("1Too1l"):InvokeServer(unpack(args))
            local args = {
                [1] = "FireHose",
                [2] = "DestroyFireHose"
            }
            game:GetService("Players").LocalPlayer.Backpack.FireHose.ToolSound:FireServer(unpack(args))
        end
        local oldcf = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(999999999.414, -475, 999999999.414)
        local rootpart = game.Players.LocalPlayer.Character.HumanoidRootPart
        repeat wait() until rootpart.Parent == nil
        repeat wait() until game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = oldcf
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Script de Dupe",
            Text = "Shutdown Conclu√≠do, Agora Vai Desligar",
            Button1 = "Ok",
            Duration = 5
        })
        wait()
        for _, ergeg in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
            if ergeg.Name == "FireHose" then
                ergeg.Parent = game.Players.LocalPlayer.Character
            end
        end
        wait(0.2)
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Script de Dupe",
            Text = "Iniciando duplica√ß√£o, seja paciente",
            Button1 = "Ok",
            Duration = 5
        })
        wait(0.5)
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(9999, -475, 9999)
    end
})

-- Shutdown Server (Internet Error) Button
TrollTab:AddButton({
    Name = "Shutdown Servidor (Erro de Internet)",
    Callback = function()
        for m = 1, 535 do
            local args = {
                [1] = "PickingTools",
                [2] = "FireHose"
            }
            game:GetService("ReplicatedStorage").RE:FindFirstChild("1Too1l"):InvokeServer(unpack(args))
            local args = {
                [1] = "FireHose",
                [2] = "DestroyFireHose"
            }
            game:GetService("Players").LocalPlayer.Backpack.FireHose.ToolSound:FireServer(unpack(args))
        end
        local oldcf = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(999999999.414, -475, 999999999.414)
        local rootpart = game.Players.LocalPlayer.Character.HumanoidRootPart
        repeat wait() until rootpart.Parent == nil
        repeat wait() until game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = oldcf
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Script de Dupe",
            Text = "Shutdown Conclu√≠do, Agora Vai Desligar",
            Button1 = "Ok",
            Duration = 5
        })
        wait()
        for _, ergeg in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
            if ergeg.Name == "FireHose" then
                ergeg.Parent = game.Players.LocalPlayer.Character
            end
        end
        wait(0.2)
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Script de Dupe",
            Text = "Iniciando duplica√ß√£o, seja paciente",
            Button1 = "Ok",
            Duration = 5
        })
        wait(0.5)
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(9999, -475, 9999)
    end
})

-- Shutdown Server (Timeout Error) Button
TrollTab:AddButton({
    Name = "Shutdown Servidor (Erro de Conex√£o Expirada)",
    Callback = function()
        for m = 1, 635 do
            local args = {
                [1] = "PickingTools",
                [2] = "FireHose"
            }
            game:GetService("ReplicatedStorage").RE:FindFirstChild("1Too1l"):InvokeServer(unpack(args))
            local args = {
                [1] = "FireHose",
                [2] = "DestroyFireHose"
            }
            game:GetService("Players").LocalPlayer.Backpack.FireHose.ToolSound:FireServer(unpack(args))
        end
        local oldcf = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = oldcf
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Script de Dupe",
            Text = "Shutdown Conclu√≠do, Agora Vai Desligar",
            Button1 = "Ok",
            Duration = 5
        })
        wait()
        for _, ergeg in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
            if ergeg.Name == "FireHose" then
                ergeg.Parent = game.Players.LocalPlayer.Character
            end
        end
        wait(0.2)
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Script de Dupe",
            Text = "Iniciando duplica√ß√£o, seja paciente",
            Button1 = "Ok",
            Duration = 5
        })
        wait(0.5)
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(9999, -475, 9999)
    end
})

-- Lag Laptop Section
local Section = TrollTab:AddSection({
    Name = "Lag com Laptop"
})

-- Toggle State for Lag Laptop
local toggles = { LagLaptop = false }

-- Function to Simulate Normal Click
local function clickNormally(object)
    local clickDetector = object:FindFirstChildWhichIsA("ClickDetector")
    if clickDetector then
        fireclickdetector(clickDetector)
    end
end

-- Function to Lag Game with Laptop
local function lagarJogoLaptop(laptopPath, maxTeleports)
    if laptopPath then
        local teleportCount = 0
        while teleportCount < maxTeleports and toggles.LagLaptop do
            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = laptopPath.CFrame
            clickNormally(laptopPath)
            teleportCount = teleportCount + 1
            wait(0.0001)
        end
    else
        warn("Laptop n√£o encontrado.")
    end
end

-- Lag Laptop Toggle
TrollTab:AddToggle({
    Name = "Lag com Laptop",
    Default = false,
    Callback = function(state)
        toggles.LagLaptop = state
        if state then
            local laptopPath = workspace:FindFirstChild("WorkspaceCom"):FindFirstChild("001_GiveTools"):FindFirstChild("Laptop")
            if laptopPath then
                spawn(function()
                    lagarJogoLaptop(laptopPath, 999999999)
                end)
            else
                warn("Laptop n√£o encontrado.")
            end
        else
            print("Lag com Laptop desativado.")
        end
    end
})

-- Lag Laptop Paragraph
TrollTab:AddParagraph({
    "Informa√ß√£o de Lag",
    "O efeito de lag come√ßa ap√≥s 35 segundos"
})

-- Lag Phone Section
local Section = TrollTab:AddSection({
    Name = "Lag com Telefone"
})

-- Toggle State for Lag Phone
toggles.LagPhone = false

-- Function to Lag Game with Phone
local function lagarJogoPhone(phonePath, maxTeleports)
    if phonePath then
        local teleportCount = 0
        while teleportCount < maxTeleports and toggles.LagPhone do
            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = phonePath.CFrame
            clickNormally(phonePath)
            teleportCount = teleportCount + 1
            wait(0.01)
        end
    else
        warn("Telefone n√£o encontrado.")
    end
end

-- Lag Phone Toggle
TrollTab:AddToggle({
    Name = "Lag com Telefone",
    Default = false,
    Callback = function(state)
        toggles.LagPhone = state
        if state then
            local phonePath = workspace:FindFirstChild("WorkspaceCom"):FindFirstChild("001_CommercialStores"):FindFirstChild("CommercialStorage1"):FindFirstChild("Store"):FindFirstChild("Tools"):FindFirstChild("Iphone")
            if phonePath then
                spawn(function()
                    lagarJogoPhone(phonePath, 999999)
                end)
            else
                warn("Telefone n√£o encontrado.")
            end
        else
            print("Lag com Telefone desativado.")
        end
    end
})

-- Lag Phone Paragraph
TrollTab:AddParagraph({
    "Informa√ß√£o de Lag",
    "O script come√ßa a causar lag ap√≥s 35 segundos"
})

local Section = TrollTab:AddSection({
    Name = "Lag com Bomba"
})

local BombActive = false

TrollTab:AddToggle({
    Name = "Lag com Bomba",
    Default = false,
    Callback = function(Value)
        if Value then
            BombActive = true

            local Player = game.Players.LocalPlayer
            local Character = Player.Character or Player.CharacterAdded:Wait()
            local RootPart = Character:WaitForChild("HumanoidRootPart")
            local WorkspaceService = game:GetService("Workspace")
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local Bomb = WorkspaceService:WaitForChild("WorkspaceCom"):WaitForChild("001_CriminalWeapons"):WaitForChild("GiveTools"):WaitForChild("Bomb")

            task.spawn(function()
                while BombActive do
                    if Bomb and RootPart then
                        RootPart.CFrame = Bomb.CFrame
                        fireclickdetector(Bomb.ClickDetector) -- Aciona o ClickDetector da bomba
                        task.wait(0.00001) -- Delay m√≠nimo para evitar travamentos
                    else
                        task.wait(0.0001) 
                    end
                end
            end)

            task.spawn(function()
                while BombActive do
                    if Bomb and RootPart then
                        local VirtualInputManager = game:GetService("VirtualInputManager")
                        VirtualInputManager:SendMouseButtonEvent(500, 500, 0, true, game, 0) 
                        task.wait(1.5)
                        VirtualInputManager:SendMouseButtonEvent(500, 500, 0, false, game, 0) 

                        -- Executa o FireServer com o nome do jogador
                        local args = {
                            [1] = "Bomb" .. Player.Name -- Usa o nome do jogador atual
                        }
                        ReplicatedStorage:WaitForChild("RE"):WaitForChild("1Blo1wBomb1sServe1r"):FireServer(unpack(args))
                    end
                    task.wait(1.5) -- Intervalo de 1 segundo para clique e FireServer
                end
            end)
        else
            -- Desativando a funcionalidade
            BombActive = false
        end
    end
})

TrollTab:AddParagraph({
    "Informa√ß√£o de Lag",
    "O script come√ßa a causar lag ap√≥s 35 segundos"
})

-- Fling section
TrollTab:AddSection({"Fling"})

TrollTab:AddButton({
    Name = "Fling Bola V3 Experimental",
    Description = "Arremessa bola com for√ßa extrema + Fling Alvo (spam CFrame para efeito server-side!)",
    Callback = flingBallV3
})

-- Handle player events
Players.PlayerRemoving:Connect(function(player)
    updateDropdown(PlayerDropdown, SpectateToggle)
    if selectedPlayer == player then
        selectedPlayer = nil
        selectedPlayerName = nil
        if isSpectating then stopSpectating() end
        SpectateToggle:Set(false)
        PlayerDropdown:Set("")
    end
end)

Players.PlayerAdded:Connect(function()
    task.wait(1)
    updateDropdown(PlayerDropdown, SpectateToggle)
end)

LocalPlayer.CharacterAdded:Connect(function()
    if isSpectating then
        stopSpectating()
        SpectateToggle:Set(false)
    end
end)

print("Lynix Hub Brookhaven carregado com sucesso!")
